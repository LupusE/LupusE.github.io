<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>OpenStack - erstes Hinfallen | LupusE webLife</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="OpenStack - erstes Hinfallen" />
<meta name="author" content="Benjamin Moeller" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Erste Schritte und harte Landungen Es ist keine gute Idee zwei unbekannte Techniken auf einmal zu verwenden, bei drei Techniken kann an davon ausgehen, dass die Zeit bis zum ersten Erfolg länger dauern kann, als das Installieren einer Technik allein. Neue Themen: Ubuntu Server und Snap LVM Linux container (lxd) (conjure-up)" />
<meta property="og:description" content="Erste Schritte und harte Landungen Es ist keine gute Idee zwei unbekannte Techniken auf einmal zu verwenden, bei drei Techniken kann an davon ausgehen, dass die Zeit bis zum ersten Erfolg länger dauern kann, als das Installieren einer Technik allein. Neue Themen: Ubuntu Server und Snap LVM Linux container (lxd) (conjure-up)" />
<link rel="canonical" href="http://blog.lupuse.org/howto/2019/03/12/openstack-erstes-hinfallen.html" />
<meta property="og:url" content="http://blog.lupuse.org/howto/2019/03/12/openstack-erstes-hinfallen.html" />
<meta property="og:site_name" content="LupusE webLife" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-03-12T22:02:08+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="OpenStack - erstes Hinfallen" />
<script type="application/ld+json">
{"headline":"OpenStack - erstes Hinfallen","description":"Erste Schritte und harte Landungen Es ist keine gute Idee zwei unbekannte Techniken auf einmal zu verwenden, bei drei Techniken kann an davon ausgehen, dass die Zeit bis zum ersten Erfolg länger dauern kann, als das Installieren einer Technik allein. Neue Themen: Ubuntu Server und Snap LVM Linux container (lxd) (conjure-up)","datePublished":"2019-03-12T22:02:08+00:00","dateModified":"2019-03-12T22:02:08+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.lupuse.org/howto/2019/03/12/openstack-erstes-hinfallen.html"},"@type":"BlogPosting","url":"http://blog.lupuse.org/howto/2019/03/12/openstack-erstes-hinfallen.html","author":{"@type":"Person","name":"Benjamin Moeller"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://blog.lupuse.org/feed.xml" title="LupusE webLife" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">LupusE webLife</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">Über mich</a><a class="page-link" href="/cv_de.html">CV (Curriculum Vitea)</a><a class="page-link" href="/impressum.html">Impressum</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">OpenStack - erstes Hinfallen</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-03-12T22:02:08+00:00" itemprop="datePublished">Mar 12, 2019
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Benjamin Moeller</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="erste-schritte-und-harte-landungen">Erste Schritte und harte Landungen</h1>
<p>Es ist keine gute Idee zwei unbekannte Techniken auf einmal zu verwenden, bei drei Techniken kann an davon ausgehen, dass die Zeit bis zum ersten Erfolg länger dauern kann, als das Installieren einer Technik allein. Neue Themen:</p>
<ol>
  <li>Ubuntu Server und Snap</li>
  <li>LVM</li>
  <li>Linux container (lxd)</li>
  <li>(conjure-up)</li>
</ol>

<h2 id="hallo-lucy">Hallo Lucy</h2>
<p>Der (für mich) neue ncurses Dialog ist etwas gewöhnungsbedürftig, aber angenehm zu lesen und Schritt-für-Schritt sinnvoll aufgebaut.</p>

<p>Der Ubuntu Server lässt sich recht schnell und sehr bequem installieren. Als Default wurde ‘Gesamte Festplatte verwenden’ vorgeschlagen. Das reicht mir nicht, ich wollte ‘Gesamte Festplatte verwenden und LVM einrichten’. LVM kenne ich noch aus alten Zeiten, und so konnten wir bequem virtuelle Festplatten von 100G bis 6T verteilen, ohne dass ein Neustart der Umgebung oder VM notwendig war. Das klingt verlockend für mein Projekt.</p>

<p>Netzwerk konfigurieren, ersten Benutzer eingeben … das Übliche halt.<br />
Aber was war an dem alten eth0 falsch? Okay, anstelle einer halb zufälligen Bezeichnung haben wir nun eine Bezeichnung nach Steckplatz im System. Da es auch kein <code class="language-plaintext highlighter-rouge">ifconfig</code> mehr gibt, sondern <code class="language-plaintext highlighter-rouge">ip a</code>, ist die Umgewöhnung vermutlich einfacher als ich gerade denke. Wer soll sich nur <code class="language-plaintext highlighter-rouge">ip a show dev enp5s0</code> merken?</p>

<p>Das mit LVM eingerichtete Ubuntu denkt 4GB sind genug für / (root). Damit bricht jeder conjure spell ab. Lösung:
Die Fehlermeldung selbst war nicht sehr aufschlussreich:</p>
<blockquote>
  <p>exception=BootstrapError(‘Unable to bootstrap (cloud type: localhost)’,)&gt;</p>
</blockquote>

<p>Lösung:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>lvextend <span class="nt">-L</span>+50G /dev/mapper/ubuntu--vg-ubuntu--lv
<span class="nv">$ </span><span class="nb">sudo </span>resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv
</code></pre></div></div>
<p>Hiermit wird das ‘Linux Volume’ für / um 50GB vergrößert und ist dann 54GB groß. Der Zweite Befehl passt das Dateisystem (ext2|3|4) darauf an.
Mit <code class="language-plaintext highlighter-rouge">df -h</code> lässt sich testen ob das Vorhaben geklappt hat.</p>

<h2 id="veraltetes-linux-container-gegen-aktuelles-linux-container-tauschen">Veraltetes ‘linux container’ gegen aktuelles ‘Linux container’ tauschen</h2>
<p>Wir rufen uns in das Gedächtnis was eine Distribution ist: Eine Sammlung von Paketen um einen Kernel (Betriebssystem), welche über einen Paketmanager einfach zu bedienen ist.<br />
Ubuntu Server hat <a href="https://linuxcontainers.org/">Linux containers (LXD)</a> vorinstalliert. Was in diversen Situationen sicher hilfreich ist, kann uns hier zum Verhängnis werden. Lösung:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt purge lxd lxd-client
</code></pre></div></div>

<p>Wir starten mit dem Einrichten von lxd. Wir bedienen uns der snap Version.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>snap <span class="nb">install </span>lxd
</code></pre></div></div>

<p>Zur Sicherheit kontrollieren wir, ob die richtige Version aktiv ist:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>which lxc
/snap/bin/lxc
</code></pre></div></div>
<p>Falsch an dieser Stelle wäre /usr/bin/lxc.</p>

<p>Der erste Benutzer sollte in der Gruppe lxd sein, aber hier noch einmal das Vorgehen:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>usermod <span class="nt">-a</span> <span class="nt">-G</span> lxd <span class="nv">$USER</span>
<span class="nv">$ </span>newgrp lxd
</code></pre></div></div>
<p>Nach dem nächsten anmelden kann mit dem Befehl <code class="language-plaintext highlighter-rouge">id</code> kontrolliert werden, ob man in der Gruppe ist.</p>

<p>Die Umgebung erstellen wir mit <code class="language-plaintext highlighter-rouge">lxc init</code>. Hier gibt es zwei wichtige Unterschiede zum Default:</p>
<ol>
  <li>OpenStack kann nur mit dem Dateisystem ‘dir’ um. Die Voreinstellung ‘btrfs’ führt zu Fehlern.</li>
  <li>OpenStack kann kein IPv6, hier muss ‘none’ eingegeben werden.</li>
</ol>

<h2 id="zusammenfassung">Zusammenfassung</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt purge lxd lxd-client<span class="p">;</span> <span class="nb">sudo </span>snap <span class="nb">install </span>lxd<span class="p">;</span> lxd init
</code></pre></div></div>
<blockquote>
  <p>Das Deinstallieren der veralteten Version der ‘Linux container’ aus apt, und installieren der neueren Version aus snap. Im Anschluss die Umgebung einrichten
An dieser Stelle auf keinen Fall vergessen <em>dir</em> als Dateisystem und <em>none</em> bei IPv6.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>lvextend <span class="nt">-L</span>+50G /dev/mapper/ubuntu--vg-ubuntu--lv<span class="p">;</span> <span class="nb">sudo </span>resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv
</code></pre></div></div>
<blockquote>
  <p>Je nachdem wie viel Speicher zur Verfügung steht können die 50G angepasst werden. Sehr viel weniger sollt es nicht sein.</p>
</blockquote>

<h1 id="lasst-die-spiele-beginnen">Lasst die Spiele beginnen!</h1>
<p>Die Magie macht für uns conjure-up.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>conjure-up
</code></pre></div></div>

<p>Ab hier gibt es genug Anleitungen über Google. Die ersten Fallstricke müsst ihr mir nicht nachmachen.<br />
je nach Ausstattung werden hier mehrere Stunden benötigt. Der Vorteil: Das System macht alles alleine. Fehler werden meist recht früh sichtbar.</p>

<p>Die traurige Realität: das ist erst die Infrastruktur. Es existiert noch kein einziger Service für die Welt.</p>

<h1 id="edit">Edit</h1>
<p>Ein i3 (2 Cores) mit 8GB Ram und 150GB drehender HDD ist vielleicht super Stromsparend, aber nicht genug Blech fuer OpenStack.<br />
Beim installieren schwankte die Load zwischen 600 und 1200. Die Install ist abgebrochen mit einem Timeout zwischen dne Services und nach einem Neustart pendelt die Load zwischen 25 und 162 …</p>

<p>Minimum Requirements sind aktuell  Cores, 16 GB RAM, 32GB SWAP (SSD recommended) und 100GB Platz. Offensichtlich nicht ohne Grund.<br />
Ich weis nicht, wie andere Testumgebungen auf dne Laptops installieren. Scheinbar gibt es noch einen anderne Trick…</p>

<p><em>Mic drop Geräusch</em></p>

  </div><a class="u-url" href="/howto/2019/03/12/openstack-erstes-hinfallen.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">LupusE webLife</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Benjamin Moeller</li><li><a class="u-email" href="mailto:git@lupuse.org">git@lupuse.org</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/LupusE"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">LupusE</span></a></li><li><a href="https://github.com/LupusE"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">LupusE</span></a></li><li><a href="https://instagram.com/lupuse42"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#instagram"></use></svg> <span class="username">lupuse42</span></a></li><li><a href="https://www.linkedin.com/in/LupusE"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">LupusE</span></a></li><li><a href="https://www.twitter.com/LupusE42"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">LupusE42</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ein Platz fuer geistige Ejakulationen und bedeutungsschwangere Worte.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
