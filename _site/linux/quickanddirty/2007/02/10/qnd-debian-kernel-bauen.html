<h2 id="vorwort">Vorwort</h2>

<p>Ich wollte im Grunde keine quick-and-dirty (Quick’n’Dirty) Howtos im Blog, da ich .txt Files bevorzuge. Erreichbar über w3m, lynx, … einfaches Kopieren und keine Datenbank, die sterben kann.<br />
Heute werde ich mich ueber meine eigenen Ideale hinwegsetzen und sündigen!</p>

<hr />
<p>Angepasster Kernel unter Debian? Dank einiger Werkzeuge gar nicht so schwer.<br />
Zuerst installiert man alle noetigen Pakete</p>

<p><code class="language-plaintext highlighter-rouge"># aptitude install gcc binutils bin86 make kernel-package tk8.2-dev libncurses5-dev wget bzip2 module-init-tools'</code></p>

<p>Nach dieser Vorbereitung zieht man sich den Kernel …</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># mkdir -p ~/sys/kernel/  </span>
<span class="c"># cd ~/sys/kernel/  </span>
<span class="c"># wget ftp://ftp.de.kernel.org/pub/linux/kernel/v&lt;$version&gt;/linux&lt;$revision&gt;.bz2  </span>
</code></pre></div></div>

<p>… und entpackt ihn.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># cd /usr/src  </span>
<span class="c"># tar xjvf /home/&lt;$user&gt;/sys/linux&lt;$revision&gt;.bz2  </span>
</code></pre></div></div>

<p>Jetzt legen wir einen Symlink an … <code class="language-plaintext highlighter-rouge"># ln -s linux&lt;$revision&gt; linux</code>
… in das Verzeichnis wechseln … <code class="language-plaintext highlighter-rouge"># cd linux</code>
… und das Konfigurationsmenu aufrufen. <code class="language-plaintext highlighter-rouge"># make menuconfig</code></p>

<p>Jetzt wird es Uneinheitlich, da die Kernelkonfiguration von der vorhandenen Hardware abhängt. Es soll ja ein ‘angepasster’ Kernel werden :)<br />
Im Grunde sage ich: Soviel als Modul wie möglich, was man beim Booten braucht (IDE/SATA, Filesystem, Framebuffer, …) in den Kernel. Mit initrd befasse ich mich ein anderes mal.</p>

<p>Nun wird der Kernel entsprechend der Konfiguration kompiliert <code class="language-plaintext highlighter-rouge"># make-kpkg kernel_image --revision=zoe1.0</code> zu finden ist das fertige Paket eine Etage tiefer <code class="language-plaintext highlighter-rouge"># cd ..</code>.<br />
Zum Abschluss installieren <code class="language-plaintext highlighter-rouge"># dpkg --install linux-image-2.6.20_zoe1.0_i386.deb</code> und das System neu starten <code class="language-plaintext highlighter-rouge"># reboot</code>.</p>

<p>Zu sehen ist das Ergebnis in der Konsole mit</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># uname -a&lt;br /&gt;</span>
Linux zoe 2.6.20 <span class="c">#1 PREEMPT Tue Jan 6 22:28:20 CET 2006 i686 GNU/Linux</span>
</code></pre></div></div>

<p>Linux, Hostname, Version, #wie oft installiert, wann kompiliert, Architektur,  GNU/Linux</p>

<p>Wenn man dann vergessen haben sollte ein Modul einzubauen, neue Hardware (z.b. usb-webcam) kauft, oder einfach nach Laune was neues probieren moechte, der wechselt wieder in das Verzeichnis des Kernels <code class="language-plaintext highlighter-rouge"># cd /usr/src/linux</code> ändert die Konfiguration. Diesesmal aber nur Module(!) entfernen und hinzufügen und aktualisiert das System:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># make modules modules_install &amp;&amp; depmod -a  </span>
<span class="c"># modprobe &lt;$modul&gt;  </span>
</code></pre></div></div>

<p>die letzten Änderungen (Module) sind auch ohne Reboot aktiv.</p>

<p>Mit ein wenig Routine automatisiert man das Wichtigste:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># cd sys/kernel/; wget ftp://ftp.de.kernel.org/pub/linux/kernel/v2.6/linux*20*.bz2; cd /usr/src/; tar xjvf ~/sys/kernel/linux*20*.bz2; ln -s linux&lt;$revision&gt; linux; cd linux; make menuconfig  </span>
<span class="c"># make-kpkg kernel_image --revision=zoe1.0; dpkg --install ../linux-image-2.6.20_zoe1.0_i386.deb  </span>
</code></pre></div></div>
