<h1 id="erste-schritte-und-harte-landungen">Erste Schritte und harte Landungen</h1>
<p>Es ist keine gute Idee zwei unbekannte Techniken auf einmal zu verwenden, bei drei Techniken kann an davon ausgehen, dass die Zeit bis zum ersten Erfolg länger dauern kann, als das Installieren einer Technik allein. Neue Themen:</p>
<ol>
  <li>Ubuntu Server und Snap</li>
  <li>LVM</li>
  <li>Linux container (lxd)</li>
  <li>(conjure-up)</li>
</ol>

<h2 id="hallo-lucy">Hallo Lucy</h2>
<p>Der (für mich) neue ncurses Dialog ist etwas gewöhnungsbedürftig, aber angenehm zu lesen und Schritt-für-Schritt sinnvoll aufgebaut.</p>

<p>Der Ubuntu Server lässt sich recht schnell und sehr bequem installieren. Als Default wurde ‘Gesamte Festplatte verwenden’ vorgeschlagen. Das reicht mir nicht, ich wollte ‘Gesamte Festplatte verwenden und LVM einrichten’. LVM kenne ich noch aus alten Zeiten, und so konnten wir bequem virtuelle Festplatten von 100G bis 6T verteilen, ohne dass ein Neustart der Umgebung oder VM notwendig war. Das klingt verlockend für mein Projekt.</p>

<p>Netzwerk konfigurieren, ersten Benutzer eingeben … das Übliche halt.<br />
Aber was war an dem alten eth0 falsch? Okay, anstelle einer halb zufälligen Bezeichnung haben wir nun eine Bezeichnung nach Steckplatz im System. Da es auch kein <code class="highlighter-rouge">ifconfig</code> mehr gibt, sondern <code class="highlighter-rouge">ip a</code>, ist die Umgewöhnung vermutlich einfacher als ich gerade denke. Wer soll sich nur <code class="highlighter-rouge">ip a show dev enp5s0</code> merken?</p>

<p>Das mit LVM eingerichtete Ubuntu denkt 4GB sind genug für / (root). Damit bricht jeder conjure spell ab. Lösung:
Die Fehlermeldung selbst war nicht sehr aufschlussreich:</p>
<blockquote>
  <p>exception=BootstrapError(‘Unable to bootstrap (cloud type: localhost)’,)&gt;</p>
</blockquote>

<p>Lösung:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>lvextend <span class="nt">-L</span>+50G /dev/mapper/ubuntu--vg-ubuntu--lv
<span class="nv">$ </span><span class="nb">sudo </span>resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv
</code></pre></div></div>
<p>Hiermit wird das ‘Linux Volume’ für / um 50GB vergrößert und ist dann 54GB groß. Der Zweite Befehl passt das Dateisystem (ext2|3|4) darauf an.
Mit <code class="highlighter-rouge">df -h</code> lässt sich testen ob das Vorhaben geklappt hat.</p>

<h2 id="veraltetes-linux-container-gegen-aktuelles-linux-container-tauschen">Veraltetes ‘linux container’ gegen aktuelles ‘Linux container’ tauschen</h2>
<p>Wir rufen uns in das Gedächtnis was eine Distribution ist: Eine Sammlung von Paketen um einen Kernel (Betriebssystem), welche über einen Paketmanager einfach zu bedienen ist.<br />
Ubuntu Server hat <a href="https://linuxcontainers.org/">Linux containers (LXD)</a> vorinstalliert. Was in diversen Situationen sicher hilfreich ist, kann uns hier zum Verhängnis werden. Lösung:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt purge lxd lxd-client
</code></pre></div></div>

<p>Wir starten mit dem Einrichten von lxd. Wir bedienen uns der snap Version.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>snap install lxd
</code></pre></div></div>

<p>Zur Sicherheit kontrollieren wir, ob die richtige Version aktiv ist:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>which lxc
/snap/bin/lxc
</code></pre></div></div>
<p>Falsch an dieser Stelle wäre /usr/bin/lxc.</p>

<p>Der erste Benutzer sollte in der Gruppe lxd sein, aber hier noch einmal das Vorgehen:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>usermod <span class="nt">-a</span> <span class="nt">-G</span> lxd <span class="nv">$USER</span>
<span class="nv">$ </span>newgrp lxd
</code></pre></div></div>
<p>Nach dem nächsten anmelden kann mit dem Befehl <code class="highlighter-rouge">id</code> kontrolliert werden, ob man in der Gruppe ist.</p>

<p>Die Umgebung erstellen wir mit <code class="highlighter-rouge">lxc init</code>. Hier gibt es zwei wichtige Unterschiede zum Default:</p>
<ol>
  <li>OpenStack kann nur mit dem Dateisystem ‘dir’ um. Die Voreinstellung ‘btrfs’ führt zu Fehlern.</li>
  <li>OpenStack kann kein IPv6, hier muss ‘none’ eingegeben werden.</li>
</ol>

<h2 id="zusammenfassung">Zusammenfassung</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt purge lxd lxd-client<span class="p">;</span> <span class="nb">sudo </span>snap install lxd<span class="p">;</span> lxd init
</code></pre></div></div>
<blockquote>
  <p>Das Deinstallieren der veralteten Version der ‘Linux container’ aus apt, und installieren der neueren Version aus snap. Im Anschluss die Umgebung einrichten
An dieser Stelle auf keinen Fall vergessen <em>dir</em> als Dateisystem und <em>none</em> bei IPv6.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>lvextend <span class="nt">-L</span>+50G /dev/mapper/ubuntu--vg-ubuntu--lv<span class="p">;</span> <span class="nb">sudo </span>resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv
</code></pre></div></div>
<blockquote>
  <p>Je nachdem wie viel Speicher zur Verfügung steht können die 50G angepasst werden. Sehr viel weniger sollt es nicht sein.</p>
</blockquote>

<h1 id="lasst-die-spiele-beginnen">Lasst die Spiele beginnen!</h1>
<p>Die Magie macht für uns conjure-up.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>conjure-up
</code></pre></div></div>

<p>Ab hier gibt es genug Anleitungen über Google. Die ersten Fallstricke müsst ihr mir nicht nachmachen.<br />
je nach Ausstattung werden hier mehrere Stunden benötigt. Der Vorteil: Das System macht alles alleine. Fehler werden meist recht früh sichtbar.</p>

<p>Die traurige Realität: das ist erst die Infrastruktur. Es existiert noch kein einziger Service für die Welt.</p>

<h1 id="edit">Edit</h1>
<p>Ein i3 (2 Cores) mit 8GB Ram und 150GB drehender HDD ist vielleicht super Stromsparend, aber nicht genug Blech fuer OpenStack.<br />
Beim installieren schwankte die Load zwischen 600 und 1200. Die Install ist abgebrochen mit einem Timeout zwischen dne Services und nach einem Neustart pendelt die Load zwischen 25 und 162 …</p>

<p>Minimum Requirements sind aktuell  Cores, 16 GB RAM, 32GB SWAP (SSD recommended) und 100GB Platz. Offensichtlich nicht ohne Grund.<br />
Ich weis nicht, wie andere Testumgebungen auf dne Laptops installieren. Scheinbar gibt es noch einen anderne Trick…</p>

<p><em>Mic drop Geräusch</em></p>
